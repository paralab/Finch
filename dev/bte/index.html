<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Phonon Boltzmann Transport · Finch</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Finch logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Finch</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Documentation for Finch</a></li><li><a class="tocitem" href="../start/">Getting started</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../mesh/">Mesh</a></li><li><a class="tocitem" href="../entities/">Entities</a></li><li><a class="tocitem" href="../conditions/">Boundary and Initial Conditions</a></li><li><a class="tocitem" href="../equation/">Equation Input</a></li><li><a class="tocitem" href="../solution/">Solution and Output</a></li><li><a class="tocitem" href="../datatypes/">Data types</a></li><li><a class="tocitem" href="../reorder/">Reordering</a></li><li><a class="tocitem" href="../misc/">Other Interface Functions</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Phonon Boltzmann Transport</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Phonon Boltzmann Transport</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/paralab/Finch/blob/master/docs/src/bte.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Phonon-Boltzmann-Transport"><a class="docs-heading-anchor" href="#Phonon-Boltzmann-Transport">Phonon Boltzmann Transport</a><a id="Phonon-Boltzmann-Transport-1"></a><a class="docs-heading-anchor-permalink" href="#Phonon-Boltzmann-Transport" title="Permalink"></a></h1><img src="../assets/images/bte2.png" alt="bte2" width="400"><p>The script file: <a href="https://github.com/paralab/Finch/blob/master/src/examples/example-bte2d-bp.jl">example-bte2d-bp.jl</a> (band-parallel),  <a href="https://github.com/paralab/Finch/blob/master/src/examples/example-bte2d-cp.jl">example-bte2d-cp.jl</a> (cell-parallel), <a href="https://github.com/paralab/Finch/blob/master/src/examples/example-bte2d-gpu.jl">example-bte2d-gpu.jl</a> (GPU)</p><p>The BTE is a particularly challenging problem due to being 7-dimensional. Since it has the form of an advection equation, the finite volume method is a good choice. Since there are many loosely coupled degrees of freedom per cell, the computation can be partitioned in different ways. This example also demonstrates the use of callback functions that are used for the boundary conditions. It also includes a post-step function that updates the temperature values. Many model-specific functions and parameters are included in separate files.</p><p>The following description is for the 2D case. A similar code can be written for 3D. Note that many details are omitted on this page. For a full code listing, see the links above. </p><pre><code class="nohighlight hljs">using Finch
initFinch(&quot;BTE2d&quot;);</code></pre><p>Then set up the configuration. This example sets dimensionality of the domain and the solver type(FV).</p><pre><code class="nohighlight hljs">domain(2) 		# dimension
solverType(FV)	# FV for finite volume
timeStepper(EULER_EXPLICIT)
setSteps(1e-12, 1000);</code></pre><p>Use the built-in simple mesh generator to make the mesh and set up all node mappings.</p><pre><code class="nohighlight hljs">mesh(QUADMESH, # quad elements
    elsperdim=[120, 120], # elements in each direction: 120 x 120 uniform grid
    interval=[0, 525e-6, 0, 525e-6],  # interval in each direction
    bids=4, # 4 boundary IDs for this mesh correspond to left, right, bottom, top
    partitions=1) # When partitioning bands, don&#39;t partition mesh</code></pre><p>Define the indices, variables, and coefficients. Note the use of CELL to define this variable as cell averages.</p><pre><code class="nohighlight hljs">direction = index(&quot;direction&quot;, range = [1,ndirs])
band = index(&quot;band&quot;, range = [1,nbands])
I = variable(&quot;I&quot;, type=VAR_ARRAY, location=CELL, index = [direction, band])
...
Sx = coefficient(&quot;Sx&quot;, dir_x, type=VAR_ARRAY)
...</code></pre><p>The boundary  and initial conditions are specified.</p><pre><code class="nohighlight hljs">boundary(I, 1, FLUX, &quot;isothermal_bdry(I, vg, Sx, Sy, band, direction, normal, 350)&quot;)
boundary(I, 2, FLUX, &quot;isothermal_bdry(I, vg, Sx, Sy, band, direction, normal, 300)&quot;)
boundary(I, 3, FLUX, &quot;symmetric_bdry(I, vg, Sx, Sy, band, direction, normal)&quot;)
boundary(I, 4, FLUX, &quot;symmetric_bdry(I, vg, Sx, Sy, band, direction, normal)&quot;)

initial(I, [equilibrium_intensity(center_freq[b], delta_freq[b], init_temp, polarizations[b]) for d=1:ndirs, b=1:nbands])</code></pre><p>A post-step function allows temperature updates after each time step.</p><pre><code class="nohighlight hljs">postStepFunction(()-&gt;update_temperature(temperature.values, temperatureLast.values, I.values, beta.values, 
                        center_freq, delta_freq, converged, polarizations, band_parallel=true));</code></pre><p>The PDE is entered in a conservation form.</p><pre><code class="nohighlight hljs">conservationForm(I, &quot;(Io[band] - I[direction,band]) * beta[band] + surface(vg[band] * upwind([Sx[direction];Sy[direction]] , I[direction,band]))&quot;)
</code></pre><p>Here the <code>upwind(S, I)</code> function applies upwinding to the advective term (S.n)u with advection velocity (Sx, Sy).</p><p>If you wish to inspect or modify the generated code, use the <code>exportCode</code> function. To then use the previously exported code, rather than generating new code, use <code>importCode</code>.</p><pre><code class="nohighlight hljs">exportCode(&quot;BTE2dcode&quot;) # exports to BTE2dcode.jl</code></pre><p>Finally, solve for I.</p><pre><code class="nohighlight hljs">solve(I);</code></pre><p>End things with <code>finalizeFinch()</code> to finish up any generated files and the log.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 6 June 2023 14:34">Tuesday 6 June 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
