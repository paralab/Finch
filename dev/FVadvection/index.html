<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Finite Volume: Advection · Finch</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Finch logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Finch</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Documentation for Finch</a></li><li><a class="tocitem" href="../start/">Getting started</a></li><li><span class="tocitem">Usage</span><ul><li><a class="tocitem" href="../configuration/">Configuration</a></li><li><a class="tocitem" href="../mesh/">Mesh</a></li><li><a class="tocitem" href="../entities/">Entities</a></li><li><a class="tocitem" href="../conditions/">Boundary and Initial Conditions</a></li><li><a class="tocitem" href="../equation/">Equation Input</a></li><li><a class="tocitem" href="../solution/">Solution and Output</a></li><li><a class="tocitem" href="../datatypes/">Data types</a></li><li><a class="tocitem" href="../reorder/">Reordering</a></li><li><a class="tocitem" href="../misc/">Other Interface Functions</a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Finite Volume: Advection</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Finite Volume: Advection</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/paralab/Finch/blob/master/docs/src/FVadvection.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Finite-Volume:-Advection"><a class="docs-heading-anchor" href="#Finite-Volume:-Advection">Finite Volume: Advection</a><a id="Finite-Volume:-Advection-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-Volume:-Advection" title="Permalink"></a></h1><img src="../assets/images/fvadvec2d.png" alt="fvadvec2d" width="400"><p>The script file: <a href="https://github.com/paralab/Finch/blob/master/src/examples/example-advection1d-fv.jl">example-advection1d-fv.jl</a>,  <a href="https://github.com/paralab/Finch/blob/master/src/examples/example-advection2d-fv.jl">example-advection2d-fv.jl</a></p><p>The finite volume method can also be used for some problems. One key difference is that the PDE will be input in the form of a conservation equation rather than the weak form. Also, variables used with FV should be defined as averages on cells rather than nodal values, though there is some ability to interpolate between them as needed. </p><p>The following description is for the 2D case. Begin by importing and using the Finch module. Then initialize. The name here is only used when generating code files.</p><pre><code class="nohighlight hljs">using Finch
initFinch(&quot;FVadvection2d&quot;);</code></pre><p>Then set up the configuration. This example sets dimensionality of the domain and the solver type(FV).</p><pre><code class="nohighlight hljs">domain(2) 		# dimension
solverType(FV)	# FV for finite volume</code></pre><p>Use the built-in simple mesh generator to make the mesh and set up all node mappings.</p><pre><code class="nohighlight hljs">n = 15 # number of elements in each direction
mesh(QUADMESH, elsperdim=n, bids=4)</code></pre><p>Define the variable and coefficient symbols. Note the use of CELL to define this variable as cell averages.</p><pre><code class="nohighlight hljs">u = variable(&quot;u&quot;, location=CELL)

coefficient(&quot;a&quot;, [&quot;cos(pi*x/2)&quot;,&quot;sin(pi*x/2)&quot;], type=VECTOR) # advection velocity</code></pre><p>The boundary condition is specified.</p><pre><code class="nohighlight hljs">boundary(u, 1, FLUX, &quot;(abs(y-0.2) &lt; 0.11) ? sin(2*pi*t)^2 : 0&quot;) # x=0
boundary(u, 2, NO_BC) # x=1
boundary(u, 3, NO_BC) # y=0
boundary(u, 4, NO_BC) # y=1</code></pre><p>The PDE must be in a conservation form.</p><pre><code class="nohighlight hljs"># The conservation type equation
# The &quot;upwind&quot; function applies upwinding to the term (a.n)*f with flow velocity a.
# The optional third parameter is for tuning. Default upwind = 0, central = 1. Choose something between these.
conservationForm([u, v, w], [&quot;surface(upwind(a,u))&quot;, &quot;surface(upwind(a,v))&quot;, &quot;surface(upwind(a,w))&quot;]) </code></pre><p>Here the <code>upwind(a,u)</code> function applies upwinding to the advective term (a.n)u with advection velocity a. An optional third parameter is for tuning. Default upwind = 0, central = 1. Choose something between these.</p><p>If you wish to inspect or modify the generated code, use the <code>exportCode</code> function. To then use the previously exported code, rather than generating new code, use <code>importCode</code>.</p><pre><code class="nohighlight hljs">exportCode(&quot;fvad2dcode&quot;) # exports to fvad2dcode.jl</code></pre><p>Finally, solve for u.</p><pre><code class="nohighlight hljs">solve(u);</code></pre><p>End things with <code>finalizeFinch()</code> to finish up any generated files and the log.</p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 21 February 2023 16:42">Tuesday 21 February 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
